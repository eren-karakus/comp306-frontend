<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Gym App</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}" defer></script>
</head>

<body>


    <div id="success-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="success-icon"></div>
            <h3 id="success-title">Success!</h3>
            <p id="success-message"></p>
            <button onclick="closeSuccessAndGoToLogin()">Go to Login</button>
        </div>
    </div>

    <div class="container">
        <div id="view-toggle-view" class="hidden"></div>
        
        <div id="login-view" class="hidden">
            <h2>Gym Login</h2>
            <form id="login-form">
                <label>Email</label>
                <input type="email" id="login-email" placeholder="Enter email:" required>
                <label>Password</label>
                <input type="password" id="login-password" placeholder="Enter password:" required>

                <button type="submit">Log In</button>
            </form>
            <p class="auth-switch">Don't have an account? <a href="#" onclick="toggleView('login-view'); toggleView('signup-view'); return false;">Sign Up</a></p>
        </div>

        <div id="signup-view" class="hidden">
            <h2>Gym Sign-up</h2>
            <form id="signup-form">
                <label>First Name</label>
                <input type="text" id="first-name" placeholder="Enter your first name:" required>
                <label>Last Name</label>
                <input type="text" id="last-name" placeholder="Enter your last name:" required>
                <label>Email</label>
                <input type="email" id="signup-email" placeholder="Enter email:" required>
                <label>Password</label>
                <input type="password" id="signup-password" placeholder="Enter password:" required>
                <label>Phone (format: 123-123-1234)</label>
                <input type="tel"
                    id="phone"
                    name="phone"
                    pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}"
                    required />
                <label>Gender</label>
                <select id="gender" name="gender" required>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                    <option value="other">Other</option>
                </select>
                <label>Date of Birth</label>
                <input type="date" id="date_of_birth"/>

                <label>Select Role</label>
                <select id="role-select">
                    <option value="athlete">Athlete</option>
                    <option value="trainer">Trainer</option>
                    <option value="medical">Medical User</option>
                </select>

                <div id="athlete-fields" class="role-fields" style="display:none;">
                    <label>Sports Branch</label>
                    <input type="text" id="sports-branch" placeholder="e.g. Basketball">
                </div>

                <div id="trainer-fields" class="role-fields" style="display:none;">
                    <label>Specialization</label>
                    <input type="text" id="specialization" placeholder="e.g. Strength Training">

                    <label>Years of Experience</label>
                    <input type="number" id="trainer-experience" min="0">
                </div>

                <div id="medical-fields" class="role-fields" style="display:none;">
                    <label>Profession</label>
                    <input type="text" id="profession" placeholder="e.g. Physiotherapist">

                    <label>Specialization Area</label>
                    <input type="text" id="specialization-area">
                </div>
                
                <button type="submit">Sign Up</button>
            </form>
            <p class="auth-switch">Already have an account? <a href="#" onclick="toggleView('signup-view'); toggleView('login-view'); return false;">Log In</a></p>
        </div>

        <div id="dashboard-view" class="hidden">
            <div class="dashboard-header">
                <h2 id="dashboard-title" style="float:left; margin:0;"></h2>
                <button class="logout-btn" onclick="logout()">Sign Out</button>
            </div>

            <div class="nav-tabs" id="nav-menu">
            </div>

            <div id="content-enrollment" class="tab-content hidden">
                <h3>Enrollment</h3>
                <div class="enrollment-section">
                    <h4>Available Programs</h4>
                    <label>Select a program to enroll</label>
                    <select id="available-programs">
                        <option value="">Select a program</option>
                    </select>
                    <button id="enroll-btn">Enroll in Program</button>
                </div>

                <div class="enrollment-section">
                    <h4>My Enrolled Programs</h4>
                    <label>Enrolled Programs</label>
                    <select id="enrollment-programs">
                        <option value="">No enrolled programs</option>
                    </select>
                </div>

                <div class="enrollment-section">
                    <h4>Workout Sessions</h4>
                    <div class="table-container">
                        <table id="workout-sessions-table">
                            <thead>
                                <tr>
                                    <th>Session Date</th>
                                    <th>Duration (min)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td colspan="2">Select a program to view sessions</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div id="content-training" class="tab-content hidden">
                <h3>Training Progress</h3>
                <label>Athlete</label>
                <select id="athlete-select">
                    <option value="">Select an athlete</option>
                </select>

                <br/>
                <div id="measurements" class="hidden">
                    <h4>Body Measurements</h4>
                    <div class="chart-container">
                        <canvas id="measurementChart"></canvas>
                    </div>
                    <div class="chart-legend">
                        <span class="legend-item"><span class="legend-color" style="background:#10b981"></span> BMI</span>
                        <span class="legend-item"><span class="legend-color" style="background:#3b82f6"></span> Body Fat %</span>
                        <span class="legend-item"><span class="legend-color" style="background:#f59e0b"></span> Muscle Mass (kg)</span>
                    </div>
                    <div class="table-container">
                        <table id="measurementTable">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Height (cm)</th>
                                    <th>Weight (kg)</th>
                                    <th>Body Fat %</th>
                                    <th>Muscle Mass (kg)</th>
                                    <th>BMI</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>

                    <h4>Medical Assessment</h4>
                    <div class="table-container">
                        <table id="medicalAssessment">
                            <thead>
                                <tr>
                                    <th>Doctor</th>
                                    <th>Date</th>
                                    <th>Type</th>
                                    <th>Notes</th>
                                    <th>Clearance</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>

                    <h4>Top 3 Exercises</h4>
                    <div class="table-container">
                        <table id="top_three_exercises">
                            <thead>
                                <tr>
                                    <th>Ranking</th>
                                    <th>Exercise</th>
                                    <th>Total Volume (Set * Rep * Weight (kg))</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>

                    <h4>Last Training Info</h4>
                    <div class="table-container">
                        <table id="lastTraining">
                            <thead>
                                <tr>
                                    <th>Exercise</th>
                                    <th>Weight (kg) Used</th>
                                    <th>Sets</th>
                                    <th>Reps</th>
                                    <th>Perceived Exertion</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>

                    <h4>Session Adherence</h4>
                    <div class="table-container">
                        <table id="sessionAdherence">
                            <thead>
                                <tr>
                                    <th>Set Completion (%)</th>
                                    <th>Rep Completion (%)</th>
                                    <th>Average Perceived Exertion</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="content-management" class="tab-content hidden">
                <h3>Training Program Management</h3>
                <button id="create-program-button">Create New Program</button>
                <button id="add-workout-session-button">Add Workout Session</button>
                <button id="add-trainer-feedback-button">Add Trainer Feedback</button>
                <button id="view-leaderboard-button">View Leaderboards</button>
                
                <div id="leaderboard-section" class="hidden">
                    <h4>Program Leaderboards (Top 5 Athletes)</h4>
                    <div id="leaderboard-container">
                        <p>Loading leaderboard...</p>
                    </div>
                </div>

                <div id="create-program-form" class="hidden">
                    <h4>Create New Program</h4>
                    
                    <label>Program Name</label>
                    <input id="training_program_name" type="text"/>

                    <label>Difficulty Level</label>
                    <select id="training_program_difficulty">
                        <option value="beginner">Beginner</option>
                        <option value="intermediate">Intermediate</option>
                        <option value="advanced">Advenced</option>
                    </select>

                    <label>Goal</label><br/>
                    <textarea id="training_program_goal"></textarea>
                    <br/>

                    <label>Start Date</label>
                    <input type="date" id="training_program_start_date"/>

                    <label>End Date</label>
                    <input type="date" id="training_program_end_date">

                    <button id="create-program-btn">Create</button>
                </div>
                <div id="add-workout-session-form" class="hidden">
                    <h4>Add Workout Session</h4>
                    
                    <label>Select Program</label>
                    <select id="trainer-program-select">
                        <option value="">Select a program</option>
                    </select>

                    <label>Session Date</label>
                    <input type="date" id="session-date">

                    <label>Duration (minutes)</label>
                    <input type="number" id="session-duration" min="1">

                    <label>Intensity Level</label>
                    <select id="session-intensity">
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                    </select>

                    <button id="add-session-btn">Add Session</button>
                </div>
                <div id="add-trainer-feedback-form" class="hidden">
                    <h4>Add Trainer Feedback</h4>
                    
                    <label>Select Athlete</label>
                    <select id="athlete-feedback-select">
                        <option value="">Select an athlete</option>
                    </select>

                    <label>Select Workout Session</label>
                    <select id="workout-session-select">
                        <option value="">Select a session</option>
                    </select>
                    <label>Rating</label>
                    <select id="feedback-rating">
                        <option value="1">1 - Poor</option>
                        <option value="2">2 - Fair</option>
                        <option value="3">3 - Good</option>
                        <option value="4">4 - Very Good</option>
                        <option value="5">5 - Excellent</option>
                    </select>

                    <label>Feedback Notes</label><br/>
                    <textarea id="feedback-notes" style="width:100%; box-sizing:border-box;"></textarea>
                    <br/>

                    <button id="add-feedback-btn">Submit Feedback</button>
            </div>
        </div>

        <div id="content-medical" class="tab-content hidden">
            <h3>Medical Assessment</h3>
            <label>Athlete</label>
            <select id="athlete-select-medical">
            </select>
            
            <div id="measurements-medical">
                <h4>Body Measurements</h4>
                <div class="table-container">
                    <table id="measurementTable-medical">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Height (cm)</th>
                                <th>Weight (kg)</th>
                                <th>Body Fat %</th>
                                <th>Muscle Mass (kg)</th>
                                <th>BMI</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <h4>Medical Assessment</h4>
                <div class="table-container">
                    <table id="medicalAssessment-medical">
                        <thead>
                            <tr>
                                <th>Doctor</th>
                                <th>Date</th>
                                <th>Type</th>
                                <th>Notes</th>
                                <th>Clearance</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <h3>New Medical Exam</h3>
                <label>Assessment Type:</label>
                <select id="assessment_type">
                    <option value="Recovery Assessment">Recovery Assessment</option>
                    <option value="Physical Examination">Physical Examination</option>
                    <option value="Nutritional Consultation">Nutritional Consultation</option>
                    <option value="Injury Assessment">Injury Assessment</option>
                    <option value="Clearance Check">Clearance Check</option>
                </select>
                <label for="medical_exam_notes">Examination Notes</label>
                <br/>
                <textarea id="medical_exam_notes"></textarea>
                <br/>
                <label>Clearance Status</label>
                <select id="clearance_status">
                    <option value="cleared">Cleared</option>
                    <option value="not_cleared">Not Cleared</option>
                    <option value="restricted">Restricted</option>
                </select>
                <button onclick="submitMedicalExam()">Submit Examination</button>
            </div>
        </div>
    </div>
</body>
</html>
